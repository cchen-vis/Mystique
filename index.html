<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Mystique</title>
    <link
      rel="stylesheet"
      href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      html {
        margin: 10px 10px 0px 10px;
        padding: 0px;
        font-family: Arial;
      }
      body {
        margin:0 20% 0 20%;
        padding: 0px;
        background: white;
        overflow-x: hidden;
        overflow-y: auto;
      }
      header img {
        float: left;
        width: 40px;
        height: 60px;
        background: white;
        margin: 0px 10px 0px 0px;
      }
      header h1 {
        font-size: 50px;
        font-weight: 600;
        color: #4f0599;
        text-shadow: 0px 0px 5px #b393d3, 0px 0px 10px #b393d3, 0px 0px 10px #b393d3,
            0px 0px 20px #b393d3;
      }
      /* header h1 {
        font-size: 50px;
        font-weight: 600;
        background-image: linear-gradient(to left, #553c9a, #b393d3);
        color: transparent;
        background-clip: text;
        -webkit-background-clip: text;
      } */
      header h2 {
        font-size: 25px;
        font-weight: 500;
        color: #553c9a;
        margin: 0px 0px 25px 0px;
      }
      .galleryDiv{
        width: 80%;
        border: 2px solid white;
        display: inline-block;
        margin: 0px 10px 0px 10px;
      }
      .columnName {
        max-width: 30%;
        min-width: 30%;
        height: 35px;
        vertical-align: text-bottom;
        text-align: center;
        border: 2px solid white;
        display: inline-block;
        margin: 0px 10px 0px 10px;
      }
      .galleryItem {
        max-width: 30%;
        min-width: 30%;
        height: 140px;
        vertical-align: text-bottom;
        text-align: center;
        border: 2px solid #eee;
        display: inline-block;
        margin: 10px 10px 0px 10px;
      }
      .galleryItem:hover {
        box-shadow: 0px 0px 5px #888;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <header>
        <img src="img/mystique.png" alt="logo" />
        <h1>Mystique</h1>
        <h2>Toward Interactive Reuse of Existing SVG Examples for Easy Chart Authoring</h2>
    </header>
    <div id="gallery">

    </div>
    <div id="uploadData">

    </div>

    <script>
      let metaData;

      function loadDemo(demo) {
        console.log(demo);
        fetch("./examples/" + demo + ".svg")
          .then((resp) => {
            return resp.text();
          })
          .then((text) => {
            let jsonArr = flattenSVG(text);
            load_spec_from_file(text, demo);
            detect(jsonArr, demo);
          });
      }

      $(document).ready(() => {
        fetch("demos.json")
          .then((resp) => {
            return resp.text();
          })
          .then((text) => {
            let thisDemo = d3.select("#gallery")
                    .append("div")
                    .attr("class", "galleryDiv")   
            thisDemo.append("div").attr("class", "columnName").html("<b>Example</b> <br>(click to open the source page)");
            thisDemo.append("div").attr("class", "columnName").html("<b>New chart after reusing</b> <br>(click to try Mystique with this example)");
            thisDemo.append("div").attr("class", "columnName").html("<b>Explanation of the new chart</b> <br> (Instructions on object-data mappings)");
            metaData = JSON.parse(text);
            for (let k of Object.keys(metaData)) {
                let thisDemo = d3.select("#gallery")
                    .append("div")
                    .attr("class", "galleryDiv")   
                thisDemo.append("a")
                    .attr("class", "galleryItem")
                    .style("background", "white")
                    .style("background-image", 'url("galleryImg/' + metaData[k].svgFileName + '_before.png")')
                    .style("background-size", "contain")
                    .style("background-repeat", "no-repeat")
                    .style("background-position", "center")
                    .attr("href", metaData[k].url)
                thisDemo.append("a")
                    .attr("class", "galleryItem")
                    .style("background", "white")
                    .style("background-image", 'url("galleryImg/' + metaData[k].svgFileName + '_after.png")')
                    .style("background-size", "contain")
                    .style("background-repeat", "no-repeat")
                    .style("background-position", "center")
                    .attr("href", window.location.href + "/demoPage.html#" + metaData[k].svgFileName)
                thisDemo.append("div")
                    .attr("class", "galleryItem")
                    .text(metaData[k].about);
            }
          });
      });
    </script>
  </body>
</html>
